spring:
  application:
    name: inventory-service
  config:
    import: "optional:configserver:http://config-server:8888"
  cloud:
    consul:
      host: consul
      port: 8500
      discovery:
        instance-id: ${spring.application.name}:${random.value}
        health-check-path: /actuator/health
        health-check-interval: 10s
    openfeign:
      client:
        config:
          default:
            connectTimeout: 5000
            readTimeout: 10000
            loggerLevel: BASIC
          catalog-service:
            connectTimeout: 3000
            readTimeout: 5000
          fleet-service:
            connectTimeout: 3000
            readTimeout: 5000
      circuitbreaker:
        enabled: true
  datasource:
    url: jdbc:mysql://${MYSQL_HOST:mysql-forestech}:${MYSQL_PORT:3306}/FORESTECHOIL?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
    username: ${MYSQL_USER:root}
    password: ${MYSQL_PASSWORD:forestech_root_2024}
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: true

server:
  port: 8083

# Resilience4j Configuration
resilience4j:
  circuitbreaker:
    instances:
      catalog-service:
        sliding-window-size: 10
        failure-rate-threshold: 50
        wait-duration-in-open-state: 10s
      fleet-service:
        sliding-window-size: 10
        failure-rate-threshold: 50
        wait-duration-in-open-state: 10s

logging:
  level:
    root: INFO
    com.forestech: DEBUG

# Distributed Tracing Configuration
management:
  tracing:
    sampling:
      probability: 0.1
  zipkin:
    tracing:
      endpoint: ${ZIPKIN_URL:http://zipkin:9411/api/v2/spans}
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus

# Security Configuration
security:
  internal-api-key: ${INTERNAL_API_KEY:forestech-internal-2024}
  internal-endpoints-enabled: ${INTERNAL_ENDPOINTS_ENABLED:true}
